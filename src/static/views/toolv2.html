<div ng-controller="toastCtrl">
</div>


<!-- CANVASES -->
<div style="height: 100%;">
    <div class="row" style="height: 90%; width: 94%; margin-left: 4%; margin-right: 2%">
        <div class="panel panel-canvases" style="height: 100%;">
            <!-- Canvases -->
            <div id="canvas-container" class="panel-body-canvases" style="height: 100%;">
                <div class="row" style="height: 50%;">
                    <div class="col-md-6" style="height: 100%; padding-right: 0">
                        <canvas id="canvas1" class="playable-canvas" style="border:1px solid #FF2D26;"></canvas>
                    </div>
                    <div class="col-md-6" style="height: 100%; padding-left: 0" >
                        <canvas id="canvas2" class="playable-canvas" style="border:1px solid #5673E8;"></canvas> 
                    </div>
                </div>
                <div class="row" style="height: 50%; ">
                    <div class="col-md-6" style="height: 100%; padding-right: 0">
                        <canvas id="canvas3" class="playable-canvas" style="border:1px solid #A66BFF;"></canvas>
                    </div>
                    <div class="col-md-6" style="height: 100%; padding-left: 0">
                        <canvas id="canvas4" class="playable-canvas" style="border:1px solid #51FF2D;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ZOOM CANVAS -->
    <canvas ng-show="canvasZoomManager.isActive()" id="canvasZoom" class="playable-canvas" style="border:3px solid #0000; pointer-events:none; position:absolute; width: 200px; height: 200px;"></canvas>
                        
    <!-- TIMELINE BEGIN -->
    <div class="row" style="height: 10%">
        <div id="TimelinePanel" class="panel panel-tool">
            <div class="panel-body">
                <div class="col-md-1">
                    <p>Step size:</p>
                    <div class="row">
                        <select class="form-control" id="selFrames" ng-change="test" ng-model="timelineManager.frameJumpNumber" ng-options="option.id as option.tag for option in timelineManager.frameJumpNumberOptions" convert-to-number>                     
                            </select>
                    </div>  
                </div>
                <div class="col-md-11">
                    <div class="row">
                        <div class="col-md-2" style="text-align: center; padding-top: 20px;">
                            <button ng-click="timelineManager.previousFrame()" class="btn btn-default"><span
                                    class="glyphicon glyphicon-chevron-left"></span></button>
                            <button ng-if="!timelineManager.isPlaying" ng-click="timelineManager.switchPlay()" class="btn btn-default"><span
                                    class="glyphicon glyphicon-play"></button>
                            <button ng-if="timelineManager.isPlaying" ng-click="timelineManager.switchPlay()" class="btn btn-default"><span
                                    class="glyphicon glyphicon-pause"></button>
                            <button ng-click="timelineManager.nextFrame()" class="btn btn-default"><span
                                    class="glyphicon glyphicon-chevron-right"></span></button>
                        </div>
                        <div class="col-md-10">
                            <rzslider rz-slider-model="timelineManager.slider.value" rz-slider-options="timelineManager.slider.options"></rzslider>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- TIMELINE END -->
    
    <!-- LOADING PANEL -->
    <div id="LoadingPanel" class="panel panel-loading animate-show-hide" ng-show="loadingScreenManager.loading==true">    
        <div class="row">
            <div class="panel" style="position: absolute; left: 30%; width: 40%; top: 20%;">
                <div class="panel-body">
                    <img ng-if="toolParameters.user.name !== 'martin'" src="/static/resources/loading.gif" />
                    <img ng-if="toolParameters.user.name === 'martin'" src="/static/resources/pdro.gif" />
                    <h2>Loading content</h2>
                    <p>Please wait</p>
                </div>
            </div>
        </div>   
    </div>  
</div>

<!-- CAMERAS PANEL (hidden panel) -->
<div id="CamerasPanel" class="panel panel-cameras" ng-show="!toolParameters.isPosetrack">
    <button class="btn btn-expand-cameras" ng-click="camerasManager.toggleCamerasPanel();">
        <div class="row">
            <span class="glyphicon glyphicon-film" style="color: white; transform: rotate(90deg);"></span>
        </div>
    </button>
    <div class="panel-body text-center " style="height: 80%; max-height: 80%; overflow-y: auto;">
        <div ng-repeat="video in camerasManager.loadedCameras">
            <div class="btn-group dropleft">
                <button class="btn btn-invisible dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <div ng-if="camerasManager.camerasPanelOpened"class="thumbnail">
                        <img class="img" style="width: 100%; height: width/1.5;" src="{{video.frames[timelineManager.slider.value - toolParameters.frameFrom].image}}" />
                        <div class="caption">
                            <p>{{video.filename}}</p>
                        </div>
                    </div>
                </button>
                <div id="MoveVideoToCameraDropdown" class="dropdown-menu text-center">
                    <li class="dropdown-header">Select the canvas to move the video</li>
                    <li class="divider"></li> 
                    <li class="text-center">
                        <button class="btn btn-default" ng-click="canvasesManager.moveToCanvas(video, 1)"><bold>1</bold></button>
                        <button class="btn btn-default" ng-click="canvasesManager.moveToCanvas(video, 2)"><bold>2</bold></button>
                    </li>
                    <li class="text-center">
                        <button class="btn btn-default" ng-click="canvasesManager.moveToCanvas(video, 3)"><bold>3</bold></button>
                        <button class="btn btn-default" ng-click="canvasesManager.moveToCanvas(video, 4)"><bold>4</bold></button>
                    </li>
                </div>
            </div>
        </div>
        <button ng-click="camerasManager.addCamera()" class="btn btn-default" style="width: 100%; height: width/1.5;"><span
                class="glyphicon glyphicon-plus" style="width: 100%; height: width/1.5;"></span></button>
    </div>
</div>

<!-- TOOLS PANEL ("floating panel) -->
<div id="ToolPanel" class="panel panel-tools text-center">
    <!-- Selector de object type -->
    <div class="btn-group dropright">
        <button class="btn btn-tool dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-tower"></span>
        </button>
        <div id="ObjectTypeDropdown" class="dropdown-menu text-center">
          <!-- Dropdown menu links -->
          <li class="dropdown-header">Selected type</li>
          <li ng-if="objectManager.selectedType.type !== undefined"><b>{{objectManager.selectedType.type}}</b></li>
          <li class="divider"></li> 
          <li class="dropdown-header">Dynamic object types</li>
          <li ng-repeat="type in objectManager.dynamicTypes"><button class="btn btn-default" ng-click="objectManager.changeSelectedType(type)" style="width: 100%;">{{type}}</button></li>
          <li class="dropdown-header">Static object types</li>
          <li ng-repeat="type in objectManager.staticTypes"><button class="btn btn-default" ng-click="objectManager.changeSelectedType(type)" style="width: 100%;">{{type}}</button></li>
        </div>
    </div>
    <hr class="tool-panel-hr">
    <div class="btn-group dropright">
        <button class="btn btn-tool dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-cog"></span>
        </button>
        <div id="OptionsDropdown" class="dropdown-menu text-center">
            <li class="dropdown-header">General options:</li>
            <li class="dropdown-item">
                Point size:
                <input type="number" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.pointSize" min="1" max="12">
            </li>
            <li class="dropdown-item">
                Font size:
                <input type="number" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.fontSize" min="1" max="12">
            </li>
            <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.showLabels"> Show labels</li>
            <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.showGuideLines"> Show guidelines</li>
            <li class="dropdown-item"><input type="checkbox" ng-model="optionsManager.options.autoInterpolate"> Auto-interpolate</li>
            <!-- <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.showStaticObjects"> Show static objects</li> -->
            <div ng-if="toolParameters.isPosetrack">
                <li class="divider"></li>
                <li class="dropdown-header">PT options:</li>
                <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.autoReplicate"> Auto-replicate</li>
            </div>
            <div ng-if="!toolParameters.isPosetrack">
                <li class="divider"></li>
                <li class="dropdown-header">AIK options:</li>
                <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.abbreviateLabels"> Abbreviate labels</li>
                <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.showSecondaryPoseJoints"> Show secondary pose joints</li>
                <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.drawLimbLengths"> Draw limb lengths</li>
                <li class="dropdown-item"><input type="checkbox" ng-change="optionsManager.optionChanged();" ng-model="optionsManager.options.quickSaveAfterJointRemoval"> Quicksave when <span class="glyphicon glyphicon-trash"></span> joints</li>
            </div>
        </div>
    </div>
    <div class="btn-group dropright">
        <button class="btn btn-tool dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="glyphicon glyphicon-list-alt"></span>
        </button>
        <div id="ShortcutsDropdown" class="dropdown-menu text-center" style="font-size: x-small;">
            <select class="form-control" id="selLayout" ng-model="shortcutsManager.shortcuts.selectedShortcuts" ng-change="shortcutsManager.unbindKeys(); shortcutsManager.bindKeys();" ng-options="shortcut as shortcut.layout for shortcut in shortcutsManager.shortcuts.layouts" ></select>                     
            <li class="divider"></li> 
            <li class="dropdown-header">Global shortcuts:</li>
            <li class="dropdown-item">Next frame: <b>{{shortcutsManager.shortcuts.selectedShortcuts.nextFrame.label}}</b></li>
            <li class="dropdown-item">Previous frame: <b>{{shortcutsManager.shortcuts.selectedShortcuts.previousFrame.label}}</b></li>
            <li class="dropdown-item">Play/Pause: <b>{{shortcutsManager.shortcuts.selectedShortcuts.playPause.label}}</b></li>
            <li class="dropdown-item">Toggle zoom: <b>{{shortcutsManager.shortcuts.selectedShortcuts.toggleZoom.label}}</b></li>
            <li class="divider"></li> 
            <li class="dropdown-header">Editor shortcuts:</li>
            <li class="dropdown-item">Next label: <b>{{shortcutsManager.shortcuts.selectedShortcuts.nextLabel.label}}</b></li>
            <li class="dropdown-item">Previous label: <b>{{shortcutsManager.shortcuts.selectedShortcuts.previousLabel.label}}</b></li>
            <li class="dropdown-item">Start annotating: <b>{{shortcutsManager.shortcuts.selectedShortcuts.startAnn.label}}</b></li>
            <li class="dropdown-item">Save annotation: <b>{{shortcutsManager.shortcuts.selectedShortcuts.saveAnn.label}}</b></li>
            <li class="dropdown-item">Delete label: <b>{{shortcutsManager.shortcuts.selectedShortcuts.deleteLabel.label}}</b></li>
            <li class="dropdown-item">Reset annotation: <b>{{shortcutsManager.shortcuts.selectedShortcuts.resetAnn.label}}</b></li>  
        </div>
    </div>
    <hr class="tool-panel-hr">
    <div class="btn-group dropright" ng-show="!toolParameters.isPosetrack">
        <button class="btn btn-tool dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span
            class="glyphicon glyphicon-th-large"></span>
        </button>
        <div id="NumberOfCanvasesDropdown" class="dropdown-menu text-center">
            <li class="dropdown-header">Select number of canvases:</li>
            <li class="divider"></li> 
            <li class="text-center">
                <button class="btn btn-default" ng-click="canvasesManager.switchNumberOfCanvases(1)"><bold>1</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.switchNumberOfCanvases(2)"><bold>2</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.switchNumberOfCanvases(3)"><bold>3</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.switchNumberOfCanvases(4)"><bold>4</bold></button>
            </li>
        </div>
    </div>
    <div class="btn-group dropright" ng-show="!toolParameters.isPosetrack">
        <button class="btn btn-tool dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span
            class="glyphicon glyphicon-th-large"></span>
            <span
            class="glyphicon glyphicon-remove" style="position: absolute;"></span>
        </button>
        <div id="NumberOfCanvasesDropdown" class="dropdown-menu text-center">
            <li class="dropdown-header">Remove camera from canvas:</li>
            <li class="divider"></li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 1">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(1)"><bold>1</bold></button>
            </li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 2">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(1)"><bold>1</bold></button>
            </li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 2">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(2)"><bold>2</bold></button>
            </li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 3">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(1)"><bold>1</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(2)"><bold>2</bold></button>
            </li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 3">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(3)"><bold>3</bold></button>
            </li>    
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 4">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(1)"><bold>1</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(2)"><bold>2</bold></button>
            </li>
            <li class="text-center" ng-if="canvasesManager.numberOfCanvases == 4">
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(3)"><bold>3</bold></button>
                <button class="btn btn-default" ng-click="canvasesManager.removeCameraFromCanvas(4)"><bold>4</bold></button>
            </li>
        </div>
    </div>
    <hr class="tool panel-hr">
    <button class="btn btn-tool" ng-click="keypointEditor.toggleActive()"><span class="glyphicon glyphicon-pushpin"></span></button>
    <button ng-if="!toolParameters.isPosetrack" class="btn btn-tool" ng-click="actionsEditor.toggleActive()"><span class="glyphicon glyphicon-tag"></span></button>
</div>

<!-- KEYPOINT EDITOR FLOATING PANEL -->
<div id="KeypointEditor" class="panel panel-floating"  style="width: 800px;" ng-show="keypointEditor.active">
    <div class="panel-heading" ng-draggable='dragOptions'>
        <div class="row">
            <div class="col-sm-1">
                <span class="glyphicon glyphicon-move"></span>
            </div>
            <div class="col-sm-9">
                Keypoint Editor
            </div>
            <div class="col-sm-1">
                <button ng-if="!keypointEditor.minimized" class="btn-invisible btn-xs" ng-click="keypointEditor.minimizeMaximize()"><span
                    class="glyphicon glyphicon-minus"></span></button>
                <button ng-if="keypointEditor.minimized" class="btn-invisible btn-xs" ng-click="keypointEditor.minimizeMaximize()"><span
                        class="glyphicon glyphicon-plus"></span></button>
            </div>
            <div class="col-sm-1">
                <button class="btn-invisible btn-xs" ng-click="keypointEditor.toggleActive()"><span
                        class="glyphicon glyphicon-remove"></span></button>
            </div>
        </div>
    </div>
    <div class="panel-body" style="height: 525px;" ng-show="!keypointEditor.minimized">
        <div ng-if="objectManager.selectedType.type === undefined">
            <p>
                Select an object type to work with in the <span class="glyphicon glyphicon-tower"></span> symbol of the left panel.
            </p>  
        </div>
        <div ng-if="!canvasesManager.atLeastOneCameraPlaced()">
            <p>
                Place at least one camera in the canvases. Expand the camera panel by clicking on the <span class="glyphicon glyphicon-film"></span> symbol at the right.
            </p>  
        </div>
        <div ng-if="objectManager.selectedType.type !== undefined && canvasesManager.atLeastOneCameraPlaced()">
            <hr>
            <div class="zui-wrapper" >
                <div class="zui-scroller">
                    <table class="zui-table">
                        <thead>
                            <tr>
                                <th></th>
                                <th ng-if="!toolParameters.isPosetrack"></th>
                                <th ng-if="objectManager.selectedType.type.localeCompare('poseAIK') == 0"></th>
                                <th class="zui-sticky-col">Objects</th>
                                <th ng-repeat="frame in toolParameters.frameList">{{frame}}</th>
                            </tr>
    
                        </thead>
                        <tbody>
                            <tr ng-repeat="object in objectManager.selectedType.objects">
                                <th><button class="btn btn-danger" ng-click="commonManager.openBatchDelete(object)"><span
                                    class="glyphicon glyphicon-transfer"></span></button></th>
                                <th ng-if="!toolParameters.isPosetrack"><button class="btn btn-danger" ng-click="keypointEditor.openTransferObject(object)"><span
                                        class="glyphicon glyphicon-random"></span></button></th>
                                <th ng-if="objectManager.selectedType.type.localeCompare('poseAIK') == 0"><button class="btn btn-danger" ng-click="keypointEditor.forceAllLimbLengthsInRange(object)"><span class="glyphicon glyphicon-resize-small"></span></button></th>        
                                <td class="zui-sticky-col">{{object.uid}} </td>
                                <th ng-repeat="f in object.frames">
                                    <button class="btn btn-success" ng-if="objectManager.annotationsState(object.uid, object.type, f.frame) == 1" ng-click="keypointEditor.openEditor(object, f.frame)"><span
                                                    class="glyphicon glyphicon-pushpin"></span></button>
                                    <button class="btn btn-info" ng-if="objectManager.annotationsState(object.uid, object.type, f.frame) == 0" ng-click="keypointEditor.openEditor(object, f.frame)"><span
                                                    class="glyphicon glyphicon-pushpin"></span></button>
                                    <button class="btn btn-warning" ng-if="objectManager.annotationsState(object.uid, object.type, f.frame) == -1" ng-click="keypointEditor.openEditor(object, f.frame)"><span
                                        class="glyphicon glyphicon-pushpin"></span></button>
                                </th>
                            </tr>
                            <tr>
                                <td class="zui-sticky-col">
                                    <button ng-if="!toolParameters.isPosetrack" class="btn btn-primary" ng-click="objectManager.createNewObject()"><span
                                                    class="glyphicon glyphicon-plus"></span></button>
                                    <button ng-if="toolParameters.isPosetrack && objectManager.selectedType.type !== 'ignore_region'"
                                            class="btn btn-primary" ng-click="commonManager.createPerson()"><span
                                            class="glyphicon glyphicon-plus"></span></button>
                                    <button ng-if="toolParameters.isPosetrack && objectManager.selectedType.type === 'ignore_region'"
                                            class="btn btn-primary" ng-click="commonManager.createIgnoreRegion()"><span
                                            class="glyphicon glyphicon-plus"></span></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- KEYPOINT EDITOR OBJECT EDITOR -->
<div id="KeypointEditorEditor" class="panel panel-floating"  style="width: 450px;" ng-show="keypointEditor.editorActive">
    <div class="panel-heading" ng-draggable='dragOptions'>
        <div class="row">
            <div class="col-sm-1">
                <span class="glyphicon glyphicon-move"></span>
            </div>
            <div class="col-sm-9">
                Keypoint Object Editor
            </div>
            <div class="col-sm-1">
                <button ng-if="!keypointEditor.editorMinimized" class="btn-invisible btn-xs" ng-click="keypointEditor.minimizeMaximizeEditor()"><span
                    class="glyphicon glyphicon-minus"></span></button>
                <button ng-if="keypointEditor.editorMinimized" class="btn-invisible btn-xs" ng-click="keypointEditor.minimizeMaximizeEditor()"><span
                        class="glyphicon glyphicon-plus"></span></button>
            </div>
            <div class="col-sm-1">
                <button class="btn-invisible btn-xs" ng-click="keypointEditor.closeEditor()"><span
                        class="glyphicon glyphicon-remove"></span></button>
            </div>
        </div>
    </div>
    <div class="panel-body" style="height: 600px;" ng-show="!keypointEditor.editorMinimized">
        <div class="row">
            <div class="col col-md-6">
                <form class="form-horizontal">
                    <div class="form-group input-group-sm">
                        <label class="control-label col-sm-4">Object type:</label>
                        <div class="col-sm-8">
                            <p class="form-control-static">{{objectManager.selectedObject.type}}</p>
                        </div>
                    </div>
                    <div class="form-group input-group-sm">
                        <label class="control-label col-sm-4">Frame:</label>
                        <div class="col-sm-8">
                            <p class="form-control-static">{{timelineManager.slider.value}}</p>
                        </div>
                    </div>
                    <div class="form-group input-group-sm">
                        <label ng-if="!toolParameters.isPosetrack"  class="control-label col-sm-4">UID:</label>
                        <label ng-if="toolParameters.isPosetrack"
                               class="control-label col-sm-4">Track ID:</label>
                        <div class="col-sm-2">
                            <p class="form-control-static">{{objectManager.selectedObject.uid}}</p>
                        </div>
                        <div class="col-sm-2">
                            <button ng-if="objectManager.selectedObject.type === 'ignore_region'"
                                    ng-click="commonManager.openChangeTrackID(objectManager.selectedObject)">
                                <span style="rotation: 90deg" class="glyphicon glyphicon-random"></span>
                            </button>
                        </div>
                        <div class="col-sm-4"></div>
                    </div>
                    <div ng-if="toolParameters.isPosetrack && keypointEditor.keypointEditorData.editorMode.localeCompare('static') !== 0"
                         class="form-group input-group-sm">
                        <label class="control-label col-sm-4">Person:</label>
                        <div class="col-sm-8">
                            <p ng-click="commonManager.openChangePersonID(objectManager.selectedObject)"
                            class="form-control-static">{{objectManager.selectedObject.person_id}}</p>
                        </div>
                    </div>
                    <div ng-if="toolParameters.isPosetrack" class="form-group input-group-sm">
                        <label class="control-label col-sm-4">UID:</label>
                        <div class="col-sm-8">
                            <p class="form-control-static">{{objectManager.selectedObject.original_uid}}</p>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col col-md-6">
                <div ng-if="toolParameters.isPosetrack" uib-carousel active="active" style="width: 100px; height: 100px;" template-url="static/views/carousel/carousel.html">
                    <div uib-slide ng-repeat="mugshot in mugshotsManager.mugshots" index="$index">
                        <img style="width: 100px; height: 100px;" ng-src="{{mugshot.image}}">
                    </div>
                </div>
                <div ng-if="!toolParameters.isPosetrack">
                    <div ng-if="objectManager.isTypeSelected('poseAIK')">
                        <div class="panel">
                            <div class="panel-heading-limbs">
                                <div class="row">
                                    <div class="col-sm-8">
                                        <h4>Limb lenghts</h4>
                                    </div>
                                    <div class="col-sm-4">
                                        <button class="btn-sm btn-success pull-right" ng-click="keypointEditor.updatePoseAIKLimbs()" data-toggle="tooltip" data-placement="right" title="Update length values"><span class="glyphicon glyphicon-upload"></span></button>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body panel-body-limbs">
                                <hr class="margin-0">
                                <div class="row">
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <p><b>Upper arm:</b></p>
                                    </div>
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <input type="number" step=".01" ng-model="keypointEditor.poseAIKLimbs.upperArm" class="form-control">
                                    </div>
                                    <div class="col-sm-2" style="padding-right: 0; padding-left: 0;">
                                        <button class="btn-sm btn-primary" ng-click="keypointEditor.forceLimbLength(0)"><span class="glyphicon glyphicon-resize-small"></span></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <p><b>Lower arm:</b></p>
                                    </div>
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <input type="number" step=".01" ng-model="keypointEditor.poseAIKLimbs.lowerArm" class="form-control">
                                    </div>
                                    <div class="col-sm-2" style="padding-right: 0; padding-left: 0;">
                                        <button class="btn-sm btn-primary" ng-click="keypointEditor.forceLimbLength(1)"><span class="glyphicon glyphicon-resize-small"></span></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <p><b>Upper leg:</b></p>
                                    </div>
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <input type="number" step=".01" ng-model="keypointEditor.poseAIKLimbs.upperLeg" class="form-control">
                                    </div>
                                    <div class="col-sm-2" style="padding-right: 0; padding-left: 0;">
                                        <button class="btn-sm btn-primary" ng-click="keypointEditor.forceLimbLength(2)"><span class="glyphicon glyphicon-resize-small"></span></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <p><b>Lower leg:</b></p>
                                    </div>
                                    <div class="col-sm-5" style="padding-right: 0; padding-left: 0;">
                                        <input type="number" step=".01" ng-model="keypointEditor.poseAIKLimbs.lowerLeg" class="form-control">
                                    </div>
                                    <div class="col-sm-2" style="padding-right: 0; padding-left: 0;">
                                        <button class="btn-sm btn-primary" ng-click="keypointEditor.forceLimbLength(3)"><span class="glyphicon glyphicon-resize-small"></span></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col col-md-8">
                <div ng-if="!toolParameters.isPosetrack">
                    <form class="form-inline">
                        <div class="form-group">
                            <label>Auto-complete:</label>
                            <button class="btn-xs btn-primary small" ng-if="objectManager.isTypeSelected('poseAIK')"
                            ng-click="commonManager.autoCompleteEachTag()">Tag-wise 
                            <span class="glyphicon glyphicon-arrow-left small"></span></button>
                            <button class="btn-xs btn-primary small" ng-if="!toolParameters.isPosetrack"
                            ng-click="commonManager.autoCompleteWholeAnnotation()">Full
                            <span class="glyphicon glyphicon-arrow-left small"></span></button>
                        </div>
                    </form>      
                </div>
                <button class="btn-xs btn-primary small" ng-if="toolParameters.isPosetrack && objectManager.isTypeSelected('ignore_region')"
                        ng-click="commonManager.replicate_backwards()">Backwards replicate
                    <span class="glyphicon glyphicon-arrow-left small"></span></button>
            </div>
            <div class="col col-md-4 text-center" style="padding-right: 0px;">
                <button class="btn-xs btn-danger small" ng-click="commonManager.deleteAnnotation()"><span class="glyphicon glyphicon-trash small"></span> Annotation</button>
            </div>
        </div>

        <div class="row" ng-if="keypointEditor.keypointEditorData.editorMode.localeCompare('static')==0 && !objectManager.isTypeSelected('ignore_region')">
            <hr>
            <div class="form-group input-group-sm">
                <label class="control-label col-sm-2">Labels:</label>
                <div class="col-sm-10">
                    <input class="form-control" type="text" ng-model="keypointEditor.keypointEditorData.annotationLabels[0]">
                </div>
            </div>
        </div>
        
        <hr>
        <div class="container" style="overflow: auto; max-height: 150px; max-width: 350px;">
            <table class="table table-hover table-bordered" style="height: 100px; width: 350px;">
                <thead>
                    <tr>
                        <th>Tag</th>
                        <th>Points</th>
                        <th>Visibility</th>
                        <th>Remove</th>
                    </tr>
                </thead>
                <tbody ng-if="keypointEditor.keypointEditorData.creationType.localeCompare('point') === 0">
                    <tr ng-repeat="tag in keypointEditor.keypointEditorData.labels">
                        <td>
                            <span ng-if="keypointEditor.selectedLabel === $index" class="glyphicon glyphicon-arrow-right"></span>
                            <span ng-if="keypointEditor.keypointEditorData.shapes[0].points[$index] === null" class="label label-primary">{{tag}}</span>
                            <span ng-if="keypointEditor.keypointEditorData.shapes[0].points[$index] !== null" class="label label-success">{{tag}}</span></td>
                        <th>  
                            <button class="btn btn-primary" ng-if="(toolsManager.subTool.localeCompare('pointCreation') !== 0 && keypointEditor.keypointEditorData.shapes[0].points[$index] === null) || (toolsManager.subTool.localeCompare('pointCreation') === 0 && keypointEditor.keypointEditorData.indexBeingEdited !== $index && keypointEditor.keypointEditorData.shapes[0].points[$index] === null)" ng-click="keypointEditor.startEditingSelectedLabel($index, 'pointCreation');"><span class="glyphicon glyphicon-edit"></span></button>
                            <button class="btn btn-success" ng-if="(toolsManager.subTool.localeCompare('pointCreation') !== 0 && keypointEditor.keypointEditorData.shapes[0].points[$index] !== null) || (toolsManager.subTool.localeCompare('pointCreation') === 0 && keypointEditor.keypointEditorData.indexBeingEdited !== $index && keypointEditor.keypointEditorData.shapes[0].points[$index] !== null)" ng-click="keypointEditor.startEditingSelectedLabel($index, 'pointCreation');"><span class="glyphicon glyphicon-edit"></span></button>
                            <button class="btn btn-warning" ng-if="toolsManager.subTool.localeCompare('pointCreation') === 0 && keypointEditor.keypointEditorData.indexBeingEdited == $index" ng-click="keypointEditor.startEditingSelectedLabel($index, '');"><span class="glyphicon glyphicon-edit"></span></button>
                        </th>
                        <th>-</th>
                        <th>
                            <button class="btn-sm btn-danger" ng-click="keypointEditor.removeEditorDataPoint($index)"><span class="glyphicon glyphicon-trash"></button>
                        </th>
                    </tr>
                    <tr ng-if="objectManager.isTypeSelected('ignore_region')">
                        <td class="zui-sticky-col">
                            <button class="btn btn-primary" ng-click="keypointEditor.addNewTag();"><span
                                class="glyphicon glyphicon-plus"></span></button>
                        </td>
                    </tr>
                </tbody>
                <tbody ng-if="keypointEditor.keypointEditorData.creationType.localeCompare('box') === 0">
                    <tr ng-repeat="tag in keypointEditor.keypointEditorData.labels">
                        <td>
                            <span ng-if="keypointEditor.selectedLabel === $index" class="glyphicon glyphicon-arrow-right"></span>
                            <span ng-if="keypointEditor.keypointEditorData.shapes[0].points[0] === null" class="label label-primary">{{tag}}</span>
                            <span ng-if="keypointEditor.keypointEditorData.shapes[0].points[0] !== null" class="label label-success">{{tag}}</span></td>
                        <th>  
                            <button class="btn btn-primary" ng-if="toolsManager.subTool.localeCompare('boxCreation') !== 0 && keypointEditor.keypointEditorData.shapes[0].points[$index] === null" ng-click="keypointEditor.setIndexBeingEdited($index); toolsManager.switchSubTool('boxCreation')"><span class="glyphicon glyphicon-edit"></span></button>
                            <button class="btn btn-success" ng-if="toolsManager.subTool.localeCompare('boxCreation') !== 0 && keypointEditor.keypointEditorData.shapes[0].points[$index] !== null" ng-click="keypointEditor.removeEditorDataPoint($index); keypointEditor.setIndexBeingEdited($index); toolsManager.switchSubTool('boxCreation')"><span class="glyphicon glyphicon-edit"></span></button>
                            <button class="btn btn-warning" ng-if="toolsManager.subTool.localeCompare('boxCreation') === 0" ng-click="keypointEditor.removeEditorDataPoint($index); toolsManager.switchSubTool('')"><span class="glyphicon glyphicon-edit"></span></button>

                        </th>
                        <th>-</th>
                        <th>
                            <button class="btn-sm btn-danger" ng-click="keypointEditor.removeEditorDataPoint($index);"><span class="glyphicon glyphicon-trash"></button>
                        </th>
                    </tr>
                </tbody>
            </table>
        </div>
        <p ng-if="objectManager.isTypeSelected('poseAIK')"><b>(*): </b>optional keypoint</p>
        <hr>
        <div class="row">
            <div class="col col-md-4">
                <button class="btn-success" ng-click="commonManager.updateAnnotation();">Save</button>
            </div>
            <div class="col col-md-4"></div>
            <div class="col col-md-4">
                <button class="btn-primary" ng-if="keypointEditor.keypointEditorData.editorMode.localeCompare('dynamic')==0" ng-click="keypointEditor.callInterpolate();">Interpolate</button>
            </div>
        </div>
        <div class="row">
            <p ng-if="objectManager.isTypeSelected('boxAIK')"> Displayed full boxes will be updated after saving!</p>
            <p ng-show="keypointEditor.keypointEditorData.modified">The object has been modified, <b>save it!</b></p>
        </div>
    </div>
</div>

<!-- ACTIONS EDITOR FLOATING PANEL -->
<div id="ActionsEditor" class="panel panel-floating"  style="width: 450px;" ng-show="actionsEditor.active">
    <div class="panel-heading" ng-draggable='dragOptions'>
        <div class="row">
            <div class="col-sm-1">
                <span class="glyphicon glyphicon-move"></span>
            </div>
            <div class="col-sm-9">
                Actions Editor
            </div>
            <div class="col-sm-1">
                <button ng-if="!actionsEditor.minimized" class="btn-invisible btn-xs" ng-click="actionsEditor.minimizeMaximize()"><span
                    class="glyphicon glyphicon-minus"></span></button>
                <button ng-if="actionsEditor.minimized" class="btn-invisible btn-xs" ng-click="actionsEditor.minimizeMaximize()"><span
                        class="glyphicon glyphicon-plus"></span></button>
            </div>
            <div class="col-sm-1">
                <button class="btn-invisible btn-xs" ng-click="actionsEditor.toggleActive()"><span
                        class="glyphicon glyphicon-remove"></span></button>
            </div>
        </div>
    </div>
    <div class="panel-body" style="height: 500px;" ng-show="!actionsEditor.minimized">
        <div ng-show="objectManager.selectedType.type === undefined">
            <p>
                Select an object type to work with in the <span class="glyphicon glyphicon-tower"></span> symbol of the left panel.
            </p>  
        </div>
        <div ng-if="!canvasesManager.atLeastOneCameraPlaced()">
            <p>
                Place at least one camera in the canvases. Expand the camera panel by clicking on the <span class="glyphicon glyphicon-film"></span> symbol at the right.
            </p>  
        </div>
        <div ng-show="objectManager.selectedType.type !== undefined && canvasesManager.atLeastOneCameraPlaced()">
            <h4>Select object:</h4>
            <div class="row">
                <select class="form-control" id="selObject" ng-change="actionManager.getActionsListByUID()" ng-model="actionManager.selectedObject" ng-options="object as object.uid for object in objectManager.selectedType.objects" convert-to-number>                     
                </select>
            </div> 
            <hr>
            <div ng-show="actionManager.selectedObject === null">
                <p>Select an object from the selector <span class="glyphicon glyphicon-arrow-up"></span></p>
            </div>
            <div ng-show="actionManager.selectedObject !== null">
                <div class="btn-group dropright" style="padding-bottom: 2px; padding-top: 2px;">
                    <button class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-plus"></span> Add action
                    </button>
                    <div id="ActionCreationDropdown" class="dropdown-menu text-center">
                        <li class="dropdown-header">Actions:</li>
                        <p><input class="form-control" type="text" ng-model="search" placeholder="Filter actions..."></p>
                        <li>
                            <select class="form-control" id="selAction" ng-model="actionManager.actionCreationData.selectedType" ng-options="activity for activity in actionManager.activitiesList | filter:search">
                            </select>
                        </li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Frame from:</li>
                        <div class="row margin-h-0 text-center">
                            <div class="col col-sm-8 padding-0">
                                <input type="number" class="form-control" id="actionFrameFrom" ng-model="actionManager.actionCreationData.startFrame">
                            </div>
                            <div class="col col-sm-4 padding-0">
                                <button class="btn btn-primary" data-toggle="tooltip" data-placement="right" title="Take actual frame" ng-click="actionsEditor.setActualFrameFrom()"><span class="glyphicon glyphicon glyphicon-screenshot"></span></button>
                            </div>
                        </div>
                        <li class="divider"></li>
                        <li class="dropdown-header">Frame to:</li>
                        <div class="row margin-h-0 text-center">
                            <div class="col col-sm-8 padding-0">
                                <input type="number" class="form-control" id="actionFrameTo" ng-model="actionManager.actionCreationData.endFrame">
                            </div>
                            <div class="col col-sm-4 padding-0">
                                <button class="btn btn-primary" data-toggle="tooltip" data-placement="right" title="Take actual frame" ng-click="actionsEditor.setActualFrameTo()"><span class="glyphicon glyphicon glyphicon-screenshot"></button>
                            </div>
                        </div>
                        <li class="divider"></li>
                        <li>
                            <button class="btn btn-sm btn-primary" ng-click="actionManager.createNewAction()">Add</button>
                        </li>

                    </div>
                </div>
                <div class="container" style="overflow: auto; max-height: 325px; max-width: 400px;">
                    <table class="table table-hover table-bordered">
                        <thead>
                            <tr>
                                <th>Remove</th>
                                <th>Action</th>
                                <th>From</th>
                                <th>To</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="actionManager.actionsList.length != 0" ng-repeat="action in actionManager.actionsList">
                                <td>
                                    <button class="btn-danger" ng-click="actionManager.removeAction(action)">
                                    <span class="glyphicon glyphicon-remove"></span>
                                </button>
                                </td>
                                <td>{{action.name}}</td>
                                <th>{{action.startFrame}}</th>
                                <th>{{action.endFrame}}</th>
                            </tr>
                            <tr ng-if="actionManager.actionsList.length == 0">
                                <td>No actions created</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div> 
        </div>
    </div>
</div>

<!-- OBJECT TYPE RESELECTION ALERT FLOATING PANEL -->
<div id="KeypointEditor" class="panel panel-alert" style="width: 300;" ng-show="toolParameters.showObjectTypeAlert" ng-click="toolParameters.closeObjectTypeAlert()">
    <div class="panel panel-body">
        <h4> <span class="glyphicon glyphicon-arrow-left"></span> Select the Object Type again.</h4>
        <small class="form-text text-muted" style="text-align: center;">Click anywhere on this panel to close it</small>
    </div>
</div>

<!-- ALL THE OTHER WINDOWS -->



